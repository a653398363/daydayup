<!--
 * @Author: fange 653398363@qq.com
 * @Date: 2023-02-07 09:53:15
 * @LastEditors: fange 653398363@qq.com
 * @LastEditTime: 2023-02-13 10:27:11
 * @FilePath: \lfange.github.io\code\test.html
 * @Description: personal written
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    <script>
      const arr = [
        {
          id: 2,
          name: '部门B',
          pid: 0,
        },
        {
          id: 3,
          name: '部门C',
          pid: 1,
        },
        {
          id: 1,
          name: '部门A',
          pid: 2,
        },
        {
          id: 4,
          name: '部门D',
          pid: 1,
        },
        {
          id: 5,
          name: '部门E',
          pid: 2,
        },
        {
          id: 6,
          name: '部门F',
          pid: 3,
        },
        {
          id: 7,
          name: '部门G',
          pid: 2,
        },
        {
          id: 8,
          name: '部门H',
          pid: 4,
        },
      ]

      console.log('arr)', flat(recrui(arr)))

      function flat(obj, res = []) {
        // 默认初始结果数组为[]
        res.push(obj) // 当前元素入栈
        // 若元素包含children，则遍历children并递归调用使每一个子元素入栈
        if (obj.children && obj.children.length) {
          for (const item of obj.children) {
            flat(item, res)
          }
        }
        return res
      }

      function recrui(data) {
        const cache = {}
        data.forEach((it) => {
          cache[it.id] = it
        })

        const res = []
        data.forEach((it) => {
          const parent = cache[it.pid]
          if (parent) (parent.children || (parent.children = [])).push(it)
          else res.push(it)
        })

        return res[0]
      }
    </script>
  </body>
</html>
