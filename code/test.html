<!--
 * @Author: fange 653398363@qq.com
 * @Date: 2023-02-07 09:53:15
 * @LastEditors: fange 653398363@qq.com
 * @LastEditTime: 2023-02-13 10:27:11
 * @FilePath: \lfange.github.io\code\test.html
 * @Description: personal written
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    <script>
      const str = 'googldddddgoogledgooogellgeog'

      function getC(p = 'google') {
        let i = 0
        let j = 0
        console.log('str', str[0])
        const next = getNext(p)
        while (i < str.length && j < p.length) {
          if (j === 0 || str[i] === p[j]) {
            i++
            j++
          } else {
            j = 0
          }
          //   console.log('str', str[i])
        }
        console.log('j ', i, j)
        console.log(
          'i - p.length',
          i - p.length,
          str.substring([i - p.length], i)
        )
        if (j > p.length - 1) {
          return i - p.length
        } else {
          console.log('pppp', next)
          return 0
        }
      }
      function getNext(p) {
        const next = []
        let len = 0
        // next[0]的情况无法推出，手动初始化一下
        next[0] = 0
        // 通过循环推进i的下标
        for (let i = 0; i < p.length; i++) {
          // 对比当前公共前后缀的下一个字符
          // 当len = 0，或者 找到了匹配的公共前后缀的时候，退出循环
          while (len > 0 && p[i] !== p[len]) {
            // 进入循环，说明当前的最长公共前后缀的下一个字符不匹配
            // 就去找较短的最长公共前后缀
            // 较短公共前后缀必然是较长公共前后缀的公共前后缀
            // 通过next[next[i - 1] - 1],找到较短为的公共前后缀
            // len = next[i - 1]
            len = next[len - 1]
          }

          // p[i] === p[len]，表示找到了，在len的基础上 + 1就是next[i]的值
          if (p[i] === p[len]) len++
          // 如果 p[i] !== p[len]，表示没找到，此时len = 0，next[i] 也等于0
          next[i] = len
        }

        return next
      }

      console.log('sssss', getC())
    </script>
  </body>
</html>
